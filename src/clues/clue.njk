---
pagination:
  data: clues
  size: 1
  alias: clue
  addAllPagesToCollections: true
permalink: "/clues/{{ clue.filename }}/index.html"
layout: base
---
<link rel="stylesheet" href="{{ site.baseUrl }}clues/clues.css">
<link rel="stylesheet" href="{{ site.baseUrl }}clues/lock.css">
<link rel="stylesheet" href="{{ site.baseUrl }}clues/progress.css">

<header>
  {% include "clues/progress-tracker.njk" %}
</header>

<main>
  <header>
    <h1>{{ clue.title }}</h1>
    {% if clue.subtitle %}<p class="clue-subtitle">{{ clue.subtitle }}</p>{% endif %}
  </header>

  {# Lock message section - will be populated by JavaScript #}
  <section class="clue-no-access" style="display: none;"></section>

{% if clue.type and 'Vision' in clue.type and clue.narrative %}
<section class="clue-narration" style="display: none;">
  <div>
    {{ clue.narrative | markdown | safe }}
  </div>
</section>
{% elif clue.appearance %}
<section class="clue-narration" style="display: none;">
  <div>
    {{ clue.appearance | markdown | safe }}
  </div>
</section>
{% elif clue.narration %}
<section class="clue-narration" style="display: none;">
  <div>
    {{ clue.narration | markdown | safe }}
  </div>
</section>
{% endif %}

{% if clue.content %}
<section class="clue-content" style="display: none;">
  <div>
    {{ clue.content | markdown | safe }}
  </div>
</section>
{% endif %}

<script>
  // Pre-compute which characters have access to this clue (build-time optimization)
  {% set accessChars = clue.skills | charactersWithAccess(characters) %}
  
  // Pass data to JavaScript - all build-time computed
  window.__clueData = {{ clue | json | safe }};
  window.__clueData.accessChars = {{ accessChars | json | safe }};
  window.__noAccessMessages = {{ refs.no_access_messages | json | safe }};
</script>
</main>