---
pagination:
  data: characters
  size: 1
  alias: character
  addAllPagesToCollections: true
permalink: "/characters/{{ character.id }}/index.html"
layout: base
---
<main>
  <header>
    <h1>{{ character.title }}</h1>
  {% if character.image %}
  <div style="text-align: center; margin: 20px 0;">
    <img src="{{ site.baseUrl }}{{ character.image }}" alt="{{ character.title }}" style="max-width: 300px; width: 100%; height: auto; border: 2px solid var(--accent-gold);">
  </div>
  {% endif %}
</header>

{% if character.personality %}
<section>
  <h2>Personality</h2>
  <p>{{ character.personality }}</p>
</section>
{% endif %}

{% if character.background %}
<section>
  <h2>Background</h2>
  <div>
    {{ character.background | markdown | safe }}
  </div>
</section>
{% endif %}

{% if character.skills %}
  {% set formattedSkills = character.skills | formatCharacterSkills(refs.skills) %}
  {% if formattedSkills.length > 0 %}
<section>
  <h2>Skills</h2>
  <ul>
    {% for skill in formattedSkills %}
    <li>{{ skill }}</li>
    {% endfor %}
  </ul>
</section>
  {% endif %}
{% endif %}

{% if character.objectives %}
<section>
  <h2>Objectives</h2>
  <ul>
    {% if character.objectives.main %}
      {% set mainQuest = quests | findQuestById(character.objectives.main) %}
      <li>
        <strong>Main:</strong> {% if mainQuest and mainQuest.objective %}{{ mainQuest.objective }}{% else %}{{ character.objectives.main }}{% endif %}
      </li>
    {% endif %}
    {% if character.objectives.private %}
      {% set privateQuest = quests | findQuestById(character.objectives.private) %}
      <li>
        <strong>Private:</strong> {% if privateQuest and privateQuest.objective %}{{ privateQuest.objective }}{% else %}{{ character.objectives.private }}{% endif %}
      </li>
    {% endif %}
  </ul>
</section>
{% endif %}

{% if character.strategy %}
<section>
  <h2>Strategy</h2>
  <div>
    {{ character.strategy | markdown | safe }}
  </div>
</section>
{% endif %}

{% if character.relationships %}
<section>
  <h2>Relationships</h2>
  <ul>
    {% for relationship in character.relationships | items %}
    <li><strong>{{ relationship[0] | replace("_", " ") | title }}:</strong> {{ relationship[1] }}</li>
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if character.starting_items and character.starting_items.length > 0 %}
<section>
  <h2>Starting Items</h2>
  <ul>
    {% for item in character.starting_items %}
    <li>{% if item.link %}<a href="{{ item.link }}">{{ item.name }}</a>{% else %}{{ item.name }}{% endif %}</li>
    {% endfor %}
  </ul>
</section>
{% endif %}

<section style="text-align: center; margin-top: 40px;">
  <a href="{{ site.baseUrl }}" class="button" id="begin-investigation-btn">Begin Investigation as {{ character.title }}</a>
</section>

<script>
(function() {
  const characterData = {{ character | json | safe }};
  
  function handleBeginInvestigation(e) {
    // Reset all progress when selecting a new character
    if (window.resetInvestigation) {
      window.resetInvestigation();
    }
    if (characterData.skills) {
      storeCharacterProfile(characterData.id, characterData.skills);
    }
    // Initialize Act I as unlocked
    window.saveToLocalStorage('unlocked_acts', ['act_i_setting']);
  }
  
  function init() {
    const button = document.getElementById('begin-investigation-btn');
    if (button) {
      button.addEventListener('click', handleBeginInvestigation);
    }
  }
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
  })();
</script>
</main>